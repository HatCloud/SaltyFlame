import type { SceneData } from '../../interface/Scene'
import {
  CheckObjectKey,
  EffectType,
  CheckDifficulty,
  // ConditionType, // Add if needed
} from '../../constant/enums'

export const scenes_261_270: SceneData = {
  '261': {
    // This scene was already present
    id: '261',
    story:
      '你被一阵绝望的叫喊惊醒了。司机猛打方向盘，长途车跌出了路沿，你感觉自己从座位上往下滑。你紧紧抓住前面的座位，不及时的话，肯定会摔得生疼。长途车发出一声闷响，停了下来。\n现在你才看到发生了什么事。一辆福特森拖拉机停在了路中央，你的司机刚才必须紧急转弯躲避这只铁皮拦路虎。他从座位上跳下马路，对开拖拉机的农民吐出一连串咒骂。\n你花了一会儿工夫才喘过气来。也许你可以帮帮忙？但是司机已经回来了。他往后倒了倒车，绕开了拖拉机，对农民怒目而视。',
    options: [{ type: 'goto', text: '继续行程', goto: '71' }],
  },
  '262': {
    id: '262',
    story:
      '你和这个巨汉开始争斗。他的拳头如铁锤一般从暗处砸来。\n处理近身战斗时，使用快速开始规则的第14～16页（规则书第102～111页）。你需要先阅读第8页（规则书第33页）来查询自己的伤害加值。\n参战者中“敏捷”最高的最先行动。你和工匠每个战斗轮各可进行一个动作。工匠每向你攻击一次，你都可以选择反击（投掷「格斗(斗殴)」）或者闪避（投掷「闪避」）。战斗技能检定是对抗检定：谁的成功度高，谁得手。\n工匠的“敏捷”为41，格斗(斗殴)技能值为35%（半值17%/五分之一值7%），耐久值为12。他每轮会攻击你一次，每次攻击成功会造成1D3+1D4点伤害。\n如果你带着小刀或类似的武器，你每次攻击成功都会造成1D4点加上伤害加值点数的伤害。如果你赤手空拳，伤害是1D3点加上伤害加值点数。\n在第三轮结束后，你可以尝试绕过这个人逃跑。这需要进行一次困难难度的「闪避」检定，如果你没有检定成功，他会再攻击一次。\n如果你将他的耐久值减少到6点或更低，前往268。\n如果你的耐久值归零，前往2。\n如果你成功逃跑，前往12。',
    // Combat scene
    // TODO: Implement combat logic.
    options: [
      { type: 'goto', text: '（战斗后，假设工匠HP <= 6）', goto: '268' },
      { type: 'goto', text: '（战斗后，假设你HP <= 0）', goto: '2' },
      { type: 'goto', text: '（战斗后，假设成功逃跑）', goto: '12' },
    ],
  },
  '263': {
    // This scene was already present
    id: '263',
    story:
      '两个面有愠色的年轻男人走下了长途车。一个人从头到脚打量了你一遍，才转头离去。司机也下了车，瞟了你一眼，穿过马路进了烟草店。等他回来的时候，他正用泛黄的手指搓着烟卷。他卷完了最后一下，一边伸手寻找火柴盒，一边仔细地观察你。他身材瘦削，约莫五十多岁，身上穿的衬衫有公共汽车公司的徽标，沾着不少污渍。但他的眼神仍然锐利地从深陷的眼眶里透出来。\n“去哪儿？”\n你把你去奥西皮(Ossipee)的票拿给他看。从那里你可以前往罗切斯特、朴次茅斯，再沿海岸线到达纽伯里波特，最后抵达阿卡姆。你也许买得起至少一部分旅程的火车票，否则这将是很多段长途汽车旅程的第一站。\n“嗯——哼.”司机擦着火柴，点燃了他的香烟。他吸了一口，烟头开始闪光。然后他又吐了一口烟，用手指了指车尾。\n“行李架在上边.”',
    info: '看看你的调查员角色卡。卡的顶部有八项属性的空位：力量(STR)、体质(CON)、意志(POW)、敏捷(DEX)、外貌(APP)、体形(SIZ)、智力(INT)和教育(EDU)。\n将以下数值分配给各项属性，写在旁边的大方格里：40、50、50、50、60、60、70、80。如果你想了解这些属性的更多信息，请阅读快速开始规则第6页（规则书第30～32页）。',
    options: [
      {
        type: 'custom_navigation',
        text: '分配属性并将行李放到行李架',
        navigationTarget: 'AttributeAllocationScreen',
        onCompleteNavigateToSceneId: '8',
        attributeValuesToAssign: [40, 50, 50, 50, 60, 60, 70, 80],
      },
    ],
  },
  '264': {
    id: '264',
    story:
      '诡异的嗥叫越来越近。你的前面、后面，都有这种声音。一声嗥叫必然有阴冷的齐声回应，低沉而饥饿。它们的声调奇异而绝望。\n你现在在以最快的速度赶路。你听到自己的呼吸声越来越急促。这片地区的树不够老，支撑不住你的重量。可能你需要跑起来。但你在被迫停步之前，又能跑多久呢——\n一群矮小黑暗的动物从树上溜下来，挡住了前面的路。每个黑影都竖着长长的尖耳朵。它们的双眼在月色下发着荧荧的光。',
    options: [
      {
        type: 'check',
        text: '进行“理智”检定',
        check: {
          details: {
            object: 'characteristic',
            subObject: CheckObjectKey.POW, // Sanity
            difficulty: CheckDifficulty.NORMAL,
          },
          onSuccessSceneId: '269',
          onFailureSceneId: '5',
          successText: '进行“理智”检定（成功）',
          failureText: '进行“理智”检定（失败）',
        },
      },
    ],
  },
  '265': {
    id: '265',
    story:
      '你解释说，你正要加入著名的密斯卡托尼克大学成为研究员。虽然这只是个初级职位，主要任务是教课和辅导，但这所学校久负盛名。谁又知道此后会发生什么呢？参与座谈会、客座演讲甚至加入遍布世界的探险行动？\n“哼.”西拉斯缩了缩鼻子。“我小时候就把书读够了。但我觉得对喜欢学习的人来说，还不错 。”\n你的「信用评级」技能是30%。\n你的本职技能是：「图书馆使用」，「外语」（选择一种），「母语」，「心理学」。你还可以选择除了「克苏鲁神话」以外的其他任意两项技能作为学术专长或个人专长。\n将以下数值分配到各项本职技能当中，写到旁边的大方格里：70%，60%，60%，50%，50%，50%，40%，40%。分配时忽略调查员角色卡上已写出的初始值。',
    options: [{ type: 'goto', text: '分配技能并继续', goto: '128' }],
  },
  '266': {
    id: '266',
    story:
      '又过了几秒钟，梅环顾四周，瞟了你几眼。然后，你听到了火柴轻轻划燃的声音。她把火柴丢到壁炉里的什么东西上，踮着脚出了房间。\n你听到她的卧室门关上以后，马上悄悄摸到壁炉前。壁炉里面点着一小堆黑色粉末，最多只有顶针大小。它散发出令人陶醉的烟气。',
    options: [
      {
        type: 'check',
        text: '进行困难「科学(植物学)」检定',
        check: {
          details: {
            object: 'skill',
            subObject: CheckObjectKey.SCIENCE_BOTANY,
            difficulty: CheckDifficulty.HARD,
          },
          onSuccessSceneId: '76',
          onFailureSceneId: '266_POST_BOTANY_FAIL', // Go to a scene that re-presents options without the check
          successText: '科学(植物学)检定成功',
          failureText: '科学(植物学)检定失败',
        },
      },
      { type: 'goto', text: '扑灭炉火再睡觉', goto: '58' },
      { type: 'goto', text: '彻夜不眠', goto: '52' },
      { type: 'goto', text: '放松下来，好奇地吸一口烟气', goto: '26' },
    ],
  },
  '266_POST_BOTANY_FAIL': {
    id: '266_POST_BOTANY_FAIL',
    story:
      '你没能辨认出这种粉末。壁炉里点着一小堆黑色粉末，最多只有顶针大小。它散发出令人陶醉的烟气。',
    options: [
      { type: 'goto', text: '扑灭炉火再睡觉', goto: '58' },
      { type: 'goto', text: '彻夜不眠', goto: '52' },
      { type: 'goto', text: '放松下来，好奇地吸一口烟气', goto: '26' },
    ],
  },
  '267': {
    id: '267',
    story:
      '你拖着行李，走过这些阴郁的建筑物。你在车里坐了一整天，感觉疲惫不堪。按照西拉斯说的路走过去，有一座朴素的石板色房顶小楼。房前挂着名牌，上面写着“莱德贝特”，下面有一块洁净的铜牌，上面写着“住宿”。你四周的小巷昏暗无光，但窗户里有一盏灯火在闪烁。\n一阵冷风吹过你的脸颊。你还不想自己的新生活从露宿街头开始。你轻轻敲起了面前饱经风霜的房门。',
    options: [{ type: 'goto', text: '继续', goto: '4' }],
  },
  '268': {
    id: '268',
    story:
      '激烈的交锋过后，你终于打出致胜一击。他下盘不稳，砰的一声摔到地板上，血从围裙上滴下来。他的眼皮颤抖着。\n你可以在「格斗(斗殴)」技能左边的小方框里打勾。',
    options: [
      {
        type: 'goto',
        text: '向他盘问防腐尸体的事',
        goto: '20',
        effects: [
          {
            type: EffectType.MARK_SKILL_SUCCESS,
            target: CheckObjectKey.FIGHTING_BRAWL,
          },
        ],
      },
      {
        type: 'goto',
        text: '丢下他前往其他地方调查',
        goto: '120',
        effects: [
          {
            type: EffectType.MARK_SKILL_SUCCESS,
            target: CheckObjectKey.FIGHTING_BRAWL,
          },
        ],
      }, // Assuming skill mark applies regardless of choice
    ],
  },
  '269': {
    id: '269',
    story:
      '虽然这些野兽成扇形面对你排开阵势，你的胸中升起黑暗的绝望，但你仍感觉有不对劲的地方。兽群的动作急躁而怪异，不像你想象的捕食者那样耐心地接近。它们越靠越近，绕着你转圈。\n你听到它们喉咙里发出刺耳的嚓嚓声，闻着它们带着麝香气的浓重气味——\n它们身忽然猛烈燃烧起来。\n你瞠目结舌，烟雾灌进了你的口鼻。这些生物燃烧着，瞪着眼睛，毛皮闪耀着火光，流着涎的下颌里滴落的也是泛红的火浪。它们的嗥叫糅合成嘈杂刺耳的悲鸣，甚至有一只直扑向你，眼睛里满是疯狂的火焰。你想后退一步，却倒呛了一大口令人窒息的烟雾，身体直直倒下——\n失去1点理智值。',
    options: [
      {
        type: 'goto',
        text: '继续',
        goto: '13',
        effects: [{ type: EffectType.CHANGE_SANITY, value: '-1' }],
      },
    ],
  },
  '270': {
    id: '270',
    story:
      '你身边旋转的火舌突然停在了半空。灯塔周围的人都僵住了，涂着黑颜料的面孔变白剥落，烬头村的上空如同有第二颗太阳突然开始照耀。\n顷刻之间，人群、村庄、山丘，一切都被摧毁了；它们离绝对的燃烧、烈焰的精华近到不可想象，瞬间就被焚化殆尽。\n尽管你的躯体被禁锢在灯塔上，但你的存在被解放了。你像星火一样直冲宇宙，弹射到广袤无垠的虚空之中。群星从你身边燃烧着掠过，速度快得不可理喻。它们就是你的家园。\n你将永远栖居于此，在这北落师门；火焰流过浩瀚太空，泛起涟漪，传导着宇宙的节奏；行星沿着不可言说的火焰之轮移转倾侧，无不处在活火焰那发条一般精确的混沌当中。\n而在这活火焰中，你将翩翩起舞。\n你以只手之力，将新罕布什尔州上方圆十六英里的一片地区毁了个干净！你也不能幸免。\n【剧终】',
    options: [{ type: 'goto', text: '游戏结束', goto: 'END' }],
  },
  END: {
    id: 'END',
    story: '游戏结束',
    options: [{ type: 'goto', text: '重新开始', goto: '1' }],
  },
}
